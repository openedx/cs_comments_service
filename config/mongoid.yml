common: &default_client
  options:
    write:
      w: <%= ENV['MONGOID_WRITE_MODE'] || 1 %>
    read:
      mode: :<%= ENV['MONGOID_READ_MODE'] || 'primary' %>
    max_retries: <%= ENV['MONGOID_MAX_RETRIES'] || 1 %>
    retry_interval: <%= ENV['MONGOID_RETRY_INTERVAL'] || 0 %>
    timeout: <%= ENV['MONGOID_TIMEOUT'] || 0.5 %>
    ssl: <%= ENV['MONGOID_USE_SSL'] || false %>

common_uri: &default_uri
  uri: <%= ENV['MONGOHQ_URL'] %>

development:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

test:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

production:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

# configuration meant to be nearly the same as prod/stage, but to get
# all it's configuration from the environment.
parameterized:
  sessions:
    default:
      hosts:
        - <%= ENV['MONGO_HOST'] + ':' + ENV['MONGO_PORT'] %>
      username: <%= ENV['MONGO_USER'] %>
      password: <%= ENV['MONGO_PASS'] %>
      database: <%= ENV['MONGO_DB'] %>
      options:
        skip_version_check: true
        safe: true
        consistency: strong

edgeprod:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

edgestage:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

staging:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

loadtest:
  clients:
    default:
      <<: *default_uri
      <<: *default_client

defaults: &defaults
  use_utc: false
  use_activesupport_time_zone: true
